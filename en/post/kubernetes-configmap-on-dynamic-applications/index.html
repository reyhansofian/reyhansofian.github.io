<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.69.0 with theme Tranquilpeak 0.4.7-BETA">
<meta name="author" content="Reyhan Sofian">
<meta name="keywords" content=", tech, development, tips, articles">
<meta name="description" content="Kubernetes has a feature called ConfigMap where it can be used as a configuration file or environment variables.">


<meta property="og:description" content="Kubernetes has a feature called ConfigMap where it can be used as a configuration file or environment variables.">
<meta property="og:type" content="article">
<meta property="og:title" content="Kubernetes ConfigMap on Dynamic Applications">
<meta name="twitter:title" content="Kubernetes ConfigMap on Dynamic Applications">
<meta property="og:url" content="https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
<meta property="twitter:url" content="https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
<meta property="og:site_name" content="Everyday I Learn">
<meta property="og:description" content="Kubernetes has a feature called ConfigMap where it can be used as a configuration file or environment variables.">
<meta name="twitter:description" content="Kubernetes has a feature called ConfigMap where it can be used as a configuration file or environment variables.">
<meta property="og:locale" content="en">

  
    <meta property="article:published_time" content="2020-05-04T23:17:28">
  
  
    <meta property="article:modified_time" content="2020-05-04T23:17:28">
  
  
  
    
      <meta property="article:section" content="programming">
    
  
  
    
      <meta property="article:tag" content="kubernetes">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@reyhan_sofian">


  <meta name="twitter:creator" content="@reyhan_sofian">






  <meta property="og:image" content="https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png">
  <meta property="twitter:image" content="https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png">


  <meta property="og:image" content="https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png">
  <meta property="twitter:image" content="https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png">




  <meta property="og:image" content="https://www.gravatar.com/avatar/291bcee126afd5d5e6fe20e2b4ce3153?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/291bcee126afd5d5e6fe20e2b4ce3153?s=640">


    <title>Kubernetes ConfigMap on Dynamic Applications</title>

    <link rel="icon" href="https://reyhansofian.github.io/favicon.png">
    

    

    <link rel="canonical" href="https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.4.6/css/flag-icon.min.css" integrity="sha256-YjcCvXkdRVOucibC9I4mBS41lXPrWfqY2BnpskhZPnw=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://reyhansofian.github.io/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    
    
    <link rel="stylesheet" href="https://reyhansofian.github.io/scss/main.min.cb8227a92f3fbced97026ddbd9a1e2ef3ed6bfcbb9db48d8a2b1ca4f579071e0.css">
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-99138527-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://reyhansofian.github.io/en/">Everyday I Learn</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://reyhansofian.github.io/#about">
    
    
    
      
        <img class="header-picture" src="https://www.gravatar.com/avatar/291bcee126afd5d5e6fe20e2b4ce3153?s=90" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://reyhansofian.github.io/#about">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/291bcee126afd5d5e6fe20e2b4ce3153?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Reyhan Sofian</h4>
        
          <h5 class="sidebar-profile-bio">Just another software engineer</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://reyhansofian.github.io/en/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://reyhansofian.github.io/en/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
  <div class="sidebar-lang">
    <ul class="sidebar-buttons">
      
      
      
      
      
      
        <li class="sidebar-button">
          <a class="sidebar-button-link" href="https://reyhansofian.github.io/id">
            <i class="sidebar-button-icon flag-icon flag-icon-id"></i>
            <span class="sidebar-button-desc">ID</span>
          </a>
        </li>
      
      
      
      
      
      
        <li class="sidebar-button">
          <a class="sidebar-button-link" href="https://reyhansofian.github.io/en">
            <i class="sidebar-button-icon flag-icon flag-icon-gb"></i>
            <span class="sidebar-button-desc">EN</span>
          </a>
        </li>
      
    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              "
       style="background-image:url('https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png')"
       data-behavior="4">
    
  </div>


      <div id="main" data-behavior="4"
        class="hasCover
               hasCoverMetaOut
               hasCoverCaption">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
            <span class="post-header-cover-caption caption"><a href="https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png">https://stackify.com/wp-content/uploads/2018/03/quick-guide-to-kubernetes-1-1280x720.png</a></span>
          
          <div class="post-header-edit-on-github main-content-wrap">
            <a href="https://www.github.com/reyhansofian/reyhansofian-blog-hugo/tree/master/content/post/2019-02-24-en-kubernetes-configmap-on-dynamic-application.md" class="btn btn--default">
              <span class="fa fa-github">
              </span>
              Edit on GitHub
            </a>
          </div>
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      Kubernetes ConfigMap on Dynamic Applications
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-05-04T23:17:28&#43;07:00">
        
  May 4, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://reyhansofian.github.io/en/categories/programming">programming</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Kubernetes has a feature called ConfigMap where it can be used as a configuration file or environment variables. We will talk about what is ConfigMap and what are the possibilities using ConfigMap?</p>
<h1 id="what-is-configmap">What is ConfigMap</h1>
<blockquote>
<p>ConfigMap allows you to decouple configuration artifacts from image content to keep containerized applications portable.</p>
</blockquote>
<p>As per Kubernetes documentation, ConfigMap is a mechanism to separate configuration from a containerized application (since we&rsquo;re talking Kubernetes, all application inside Kubernetes is containerized). This will lead the applications to be more portable and more configurable. ConfigMap usage is more suitable for a configuration that doesn&rsquo;t contain sensitive information since it doesn&rsquo;t have any encryption.</p>
<h1 id="how-configmap-works">How ConfigMap works?</h1>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/600/1*GoB8Po84hhM707uIi_xZVA.png" title="Image 1.1 — Create ConfigMap" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/600/1*GoB8Po84hhM707uIi_xZVA.png"  alt="Image 1.1 — Create ConfigMap">
  
    </a>
  
   
    <span class="caption">Image 1.1 — Create ConfigMap</span>
  
</div>

  <div style="clear:both;"></div>

<p>There are 3 ways to create ConfigMap:</p>
<ol>
<li><code>--from-file</code> flag. Example: <code>kubectl create configmap myConfigMap --from-file /my/path/to/directory/or/file</code></li>
<li><code>--from-literal</code> flag. Example: <code>kubectl create configmap myConfigMap --from-literal KEY1=VALUE1 KEY2=VALUE2</code></li>
<li>With Kubernetes manifest with kind <code>ConfigMap</code>. We can create a file with <code>.yaml</code> or <code>.json</code>, and the we can apply it using <code>kubectl apply -f myConfigMap.yaml</code></li>
</ol>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/600/1*KQjy0ceER44muI5_kZkdLA.png" title="Image 1.2 — Apply ConfigMap" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/600/1*KQjy0ceER44muI5_kZkdLA.png"  alt="Image 1.2 — Apply ConfigMap">
  
    </a>
  
   
    <span class="caption">Image 1.2 — Apply ConfigMap</span>
  
</div>

  <div style="clear:both;"></div>

<p><code>kubectl create configmap</code> or <code>kubectl apply -f &lt;file&gt;</code> command will upload the ConfigMap definition to the Kubernetes Apiserver that lives inside Kubernetes cluster.</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/600/1*bVutgbPL5mfpdhnMTzFiAQ.png" title="Image 1.3 — ConfigMap distribution by Apiserver" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/600/1*bVutgbPL5mfpdhnMTzFiAQ.png"  alt="Image 1.3 — ConfigMap distribution by Apiserver">
  
    </a>
  
   
    <span class="caption">Image 1.3 — ConfigMap distribution by Apiserver</span>
  
</div>

  <div style="clear:both;"></div>

<p>The Apiserver will distribute the ConfigMap definition to all Pods inside the cluster.</p>
<h1 id="how-to-use-configmap">How to use ConfigMap?</h1>
<p>There are 2 ways to use ConfigMap</p>
<h3 id="1-as-environment-variable">1. As environment variable</h3>
<p>As an example, we will create a ConfigMap like this</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1000/1*UmIEX_zGQqrxNbTjdEyuGw.png" title="Image 2.1 - ConfigMap" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1000/1*UmIEX_zGQqrxNbTjdEyuGw.png"  alt="Image 2.1 - ConfigMap">
  
    </a>
  
   
    <span class="caption">Image 2.1 - ConfigMap</span>
  
</div>

  <div style="clear:both;"></div>

<p><em><strong>Descriptions:</strong></em></p>
<p>    1. <em>ConfigMap name</em><br>
    2. <em>ConfigMap data (can be in KEY-VALUE format or filename format)</em></p>
<p>We will attach the ConfigMap values to a Pod and use it as environment variables</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1000/1*zSVWgoFVokE6MRPYvp3-MQ.png" title="Image 2.2 - Pod Manifest" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1000/1*zSVWgoFVokE6MRPYvp3-MQ.png"  alt="Image 2.2 - Pod Manifest">
  
    </a>
  
   
    <span class="caption">Image 2.2 - Pod Manifest</span>
  
</div>

  <div style="clear:both;"></div>

<p><em><strong>Descriptions:</strong></em></p>
<p>    1. Environment variable&rsquo;s name that will be injected into Pod<br>
    2. Reference to a particular ConfigMap name. This can be found from <strong>metada.name</strong> on the ConfigMap manifest<br>
    3. ConfigMap key name that we will use<br>
    4. Load all key and values from another ConfigMap \</p>
<h3 id="2-as-a-volume-that-attached-to-a-pod">2. As a volume that attached to a Pod</h3>
<p>ConfigMap also supports the Volume plugin. For instances, we will use the same ConfigMap manifest and we will create a Pod manifest like this</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*q7EtLCY9rEhRH_on0ZZl1w.png" title="Image 2.3 - Pod manifest using Volume plugin" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*q7EtLCY9rEhRH_on0ZZl1w.png"  alt="Image 2.3 - Pod manifest using Volume plugin">
  
    </a>
  
   
    <span class="caption">Image 2.3 - Pod manifest using Volume plugin</span>
  
</div>

  <div style="clear:both;"></div>

<p><em><strong>Descriptions:</strong></em></p>
<p>    1. Volume name that will be used. In this example, it will use the volume from number 3 which is &ldquo;config-volume&rdquo; volume<br>
    2. Volume mount path<br>
    3. Volume name<br>
    4. ConfigMap name that will be used by the &ldquo;config-volume&rdquo; volume \</p>
<hr>
<p>Using the ConfigMap as environment variables using volume will lead us to a possibility where we can update Pod&rsquo;s environment variables without the need to restart. This method usually called as <em><strong>&ldquo;live-update&rdquo;</strong></em> or <em><strong>&ldquo;hot-config&rdquo;</strong></em>.</p>
<p>Why do we need <em><strong>&ldquo;live-update&rdquo;</strong></em>? In the world of the container, the environment variables will be set in stone if the application (or container) is already running. This means we can&rsquo;t change the environment variables on the fly if we are injecting environment variables using <code>docker run -e &lt;KEY&gt;=&lt;VALUE&gt;</code> (for Docker) or using <code>env</code> (for Kubernetes Pod). Instead, we can use a file to store the environment variables. And in this example, we will use ConfigMap that will be attached to a Pod volume.</p>
<p>Let&rsquo;s examine the ConfigMap behavior if it got an update. Let&rsquo;s create a simple ConfigMap manifest like this</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*jYIXmJHAv97m7XQZUWh-DQ.png" title="Image 3.1 - Simple ConfigMap" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*jYIXmJHAv97m7XQZUWh-DQ.png"  alt="Image 3.1 - Simple ConfigMap">
  
    </a>
  
   
    <span class="caption">Image 3.1 - Simple ConfigMap</span>
  
</div>

  <div style="clear:both;"></div>

<p>After applied it using <code>kubectl apply -f</code>, let&rsquo;s take a look inside the Pod&rsquo;s container how ConfigMap works as environment variables. We will go to the volume mount path directory based on the Pod configuration (in this case, it mounts to <code>/etc/config</code>)</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*MiKDIUvl72yUvlIfUqs6KQ.png" title="Image 3.2 - ConfigMap inside a Pod&#39;s container" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*MiKDIUvl72yUvlIfUqs6KQ.png"  alt="Image 3.2 - ConfigMap inside a Pod&#39;s container">
  
    </a>
  
   
    <span class="caption">Image 3.2 - ConfigMap inside a Pod&#39;s container</span>
  
</div>

  <div style="clear:both;"></div>

<p>If we look at the image above, every key that we define on ConfigMap will be mounted as files by Kubernetes. These files have symlinks to <code>...data</code> folder and inside that folder have the same names. For example Misal <code>ENV_IS_MAINTENANCE</code> symlinked to <code>..data/ENV_IS_MAINTENACE</code>, etc. Also <code>..data</code> folder symlinked to another folder called <code>..2019_02_22_04_00_47.246998214</code>.</p>
<p>Now for proof of concept, let&rsquo;s create a simple application using NodeJS and ExpressJS and ship it as a container. This application main purpose is to read the environment variables from ConfigMap and listen to that folder if there is an update</p>


  
  
  
  
  


  
    
  
  
    
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span><a href="https://gist.github.com/reyhansofian/9d9d8f7f242364595a56753bdeae721e#file-index-js">index.js</a></span>
    
    <ul class="tabs">
      
        <li class="tab active">js</li>
      
    </ul>
  </figcaption> 
  <div class="tabs-content">
    
      
      <figure class="highlight language-js" style="display: block;">   
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-js"><code class="js">// @ts-check

const express = require(&#34;express&#34;);
const app = express();
const fs = require(&#34;fs&#34;);
const bodyParser = require(&#39;body-parser&#39;);

// volume mount path
const mountPath = &#34;/etc/config&#34;;

// ConfigMap filename
const configMapFile = &#34;..data&#34;;

// watching file
fs.watch(`${mountPath}`, (event, filename) =&gt; {
  // only listen to event &#34;rename&#34;.
  // kubelet will rename the reference folder on ConfigMap update.
  if (event === &#34;rename&#34; &amp;&amp; filename) {
    if (filename === configMapFile) {
      console.log(`process.env BEFORE: ${JSON.stringify(process.env)}`);

      // get all files from `..data` directory
      const dir = fs.readdirSync(`${mountPath}/${configMapFile}`);

      console.log(`Env list: ${dir}`);

      // read all files inside `..data` directory
      dir.forEach(env =&gt; {
        // inject the new envar value to `process.env` object (not recommended)
        process.env[env] = fs.readFileSync(
          `${mountPath}/${configMapFile}/${env}`
        );
      });

      console.log(`process.env AFTER: ${JSON.stringify(process.env)}`);
    }
  }
});

// for readinessProbe and livelinessProbe Kubernetes
app.get(&#34;/info&#34;, (req, res) =&gt; {
  res.sendStatus(200);
});

app.get(&#34;/isMaintenance&#34;, (req, res) =&gt; {
  const isMaintenace = process.env.ENV_IS_MAINTENANCE;

  res.status(200).send(`Is it maintenance? ${isMaintenace}`);
})

app.listen(3000, err =&gt; {
  if (err) {
    console.error(err);
    process.exit(1);
  }

  console.log(`Server is up on port 3000`);
});</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>
<p>Those code above will listen to a <strong>&ldquo;rename&rdquo;</strong> event inside <code>/etc/config</code> folder. Let&rsquo;s containerized it and deploy it to Kubernetes. As usual, we will run <code>kubectl apply -f</code> to create the Kubernetes Service, Deployment, and Pod at the same time.</p>


  
  
  
  
  


  
    
  
  
    
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span><a href="https://gist.github.com/reyhansofian/89da577d93c6c191beef34cfeae2dca4#file-test-k8s-yaml">test-k8s.yaml</a></span>
    
    <ul class="tabs">
      
        <li class="tab active">yaml</li>
      
    </ul>
  </figcaption> 
  <div class="tabs-content">
    
      
      <figure class="highlight language-yaml" style="display: block;">   
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-yaml"><code class="yaml">apiVersion: v1
kind: Service
metadata:
  labels:
    test-app: test
  name: test
  namespace: default
spec:
  externalTrafficPolicy: Cluster
  ports:
  - nodePort: 30321
    port: 3000
    protocol: TCP
    targetPort: 3000
  selector:
    test-app: test
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: {}
---
apiVersion: extensions/v1
kind: Deployment
metadata:
  name: test
spec:
  revisionHistoryLimit: 2
  strategy:
    type: RollingUpdate
  replicas: 1
  selector:
    matchLabels:
      test-app: test
  template:
    metadata:
      labels:
        test-app: test
    spec:
      volumes:
        - name: config-volume
          configMap:
            name: test-config
      containers:
        - name: test
          image: reyhan/docker-try-config:1.0.0
          command: [&#34;npm&#34;, &#34;start&#34;]
          imagePullPolicy: Never
          livenessProbe:
            httpGet:
              path: /info
              port: 3000
            initialDelaySeconds: 90
            periodSeconds: 5
          readinessProbe:
            httpGet:
              path: /info
              port: 3000
            initialDelaySeconds: 5
            periodSeconds: 5
          ports:
            - containerPort: 3000
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
          resources:
            requests:
              memory: &#34;256Mi&#34;
              cpu: &#34;64m&#34;
            limits:
              memory: &#34;512Mi&#34;
              cpu: &#34;256m&#34;
          env:
            - name: ENV_SQL_CLIENT
              value: &#34;mysql&#34;
            - name: ENV_SQL_HOST
              value: &#34;13.67.44.182&#34;
            - name: ENV_IS_MAINTENANCE
              valueFrom:
                configMapKeyRef:
                  name: test-config
                  key: ENV_IS_MAINTENANCE
            - name: ENV_IS_BLOWN_UP
              valueFrom:
                configMapKeyRef:
                  name: test-config
                  key: ENV_IS_BLOWN_UP</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>
<p>Next, let&rsquo;s update the ConfigMap value to</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*H9gsRDvKQeydrJWp6QInBg.png" title="Image 3.3 - Change the &#34;ENV_IS_MAINTENTANCE&#34; key on ConfigMap" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*H9gsRDvKQeydrJWp6QInBg.png"  alt="Image 3.3 - Change the &#34;ENV_IS_MAINTENTANCE&#34; key on ConfigMap">
  
    </a>
  
   
    <span class="caption">Image 3.3 - Change the &#34;ENV_IS_MAINTENTANCE&#34; key on ConfigMap</span>
  
</div>

  <div style="clear:both;"></div>


 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*-chB0yixX6GdBfW3ZA0oDQ.png" title="Image 3.4 — Environment variables inside container has been modified" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*-chB0yixX6GdBfW3ZA0oDQ.png"  alt="Image 3.4 — Environment variables inside container has been modified">
  
    </a>
  
   
    <span class="caption">Image 3.4 — Environment variables inside container has been modified</span>
  
</div>

  <div style="clear:both;"></div>

<p>From the image above, the symlinks between environment variables files didn&rsquo;t change at all. The only change is the symlink for <code>...data</code> changed to a new folder called <code>..2019_02_23_19_01_09.591362024</code>. For more clarity, take a look at the short gif below</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/2000/1*0kLzHvwruLapTKbvgqaOKA.gif" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/2000/1*0kLzHvwruLapTKbvgqaOKA.gif" >
  
    </a>
  
  
</div>

  <div style="clear:both;"></div>

<p>As we can see, updating environment variables using this method is quite easy since we don&rsquo;t need to redeploy the Pod at all!</p>
<p>But there are some things worth to note:</p>
<ol>
<li>ConfigMap only &ldquo;live&rdquo; inside a namespace. Which mean it can&rsquo;t be shared to another namespace</li>
<li>ConfigMap update is eventually consistent which means it doesn&rsquo;t update immediately after we update it. This is the default behavior from the Kubernetes (kubelet to be specific) where the sync frequency every 60 seconds. If we want to make it faster, we can change the <code>--sync-frequency</code> on the kubelet. Please look at the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#mounted-configmaps-are-updated-automatically">official documentation</a> for more reference</li>
</ol>
<hr>
<h1 id="extra">Extra!</h1>
<p>The implementation of the <strong>&ldquo;live-update&rdquo;</strong> above can only work on NodeJS applications since it has <code>fs</code> standard library which can listen to the filesystem events (<code>fs.watch</code>). If we want to implement &ldquo;live-update&rdquo; on other than NodeJS, so we need to adjust our code and our Pod&rsquo;s deployment. For simplicity, we still using NodeJS but not using <code>fs.watch</code>.</p>


  
  
  
  
  


  
    
  
  
    
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span><a href="https://gist.github.com/reyhansofian/af1bab9b437dcfb570fa263e101635bb#file-k8s-yaml">k8s.yaml</a></span>
    
    <ul class="tabs">
      
        <li class="tab active">yaml</li>
      
    </ul>
  </figcaption> 
  <div class="tabs-content">
    
      
      <figure class="highlight language-yaml" style="display: block;">   
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-yaml"><code class="yaml">apiVersion: v1
kind: Service
metadata:
  labels:
    test-app: test
  name: test
  namespace: default
spec:
  externalTrafficPolicy: Cluster
  ports:
  - nodePort: 30321
    port: 3000
    protocol: TCP
    targetPort: 3000
  selector:
    test-app: test
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: {}
---
apiVersion: extensions/v1
kind: Deployment
metadata:
  name: test
spec:
  revisionHistoryLimit: 2
  strategy:
    type: RollingUpdate
  replicas: 1
  selector:
    matchLabels:
      test-app: test
  template:
    metadata:
      labels:
        test-app: test
    spec:
      volumes:
        - name: config-volume
          configMap:
            name: test-config
      containers:
        - name: configmap-reload
          image: &#34;jimmidyson/configmap-reload:v0.1&#34;
          imagePullPolicy: &#34;IfNotPresent&#34;
          args:
            - --volume-dir=/etc/config
            - --webhook-url=http://localhost:3000/-/reload
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
              readOnly: true
        - name: test
          image: reyhan/docker-try-config:1.0.3
          command: [&#34;npm&#34;, &#34;start&#34;]
          imagePullPolicy: Never
          livenessProbe:
            httpGet:
              path: /info
              port: 3000
            initialDelaySeconds: 90
            periodSeconds: 5
          readinessProbe:
            httpGet:
              path: /info
              port: 3000
            initialDelaySeconds: 5
            periodSeconds: 5
          ports:
            - containerPort: 3000
          volumeMounts:
            - name: config-volume
              mountPath: /etc/config
          resources:
            requests:
              memory: &#34;256Mi&#34;
              cpu: &#34;64m&#34;
            limits:
              memory: &#34;512Mi&#34;
              cpu: &#34;256m&#34;
          env:
            - name: ENV_SQL_CLIENT
              value: &#34;mysql&#34;
            - name: ENV_SQL_HOST
              value: &#34;13.67.44.182&#34;
            - name: ENV_IS_MAINTENANCE
              valueFrom:
                configMapKeyRef:
                  name: test-config
                  key: ENV_IS_MAINTENANCE
            - name: ENV_IS_BLOWN_UP
              valueFrom:
                configMapKeyRef:
                  name: test-config
                  key: ENV_IS_BLOWN_UP</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*b_xFQ5VYDIY54QKuzFE1Qw.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*b_xFQ5VYDIY54QKuzFE1Qw.png" >
  
    </a>
  
  
</div>

  <div style="clear:both;"></div>

<p>If we look closely at the container&rsquo;s configuration above, we add a new container from <a href="https://github.com/jimmidyson/configmap-reload">jimmidyson/configmap-reload</a> with its configurations to read the ConfigMap. This method usually called <strong>&ldquo;sidecar container&rdquo;</strong>.</p>


  
  
  
  
  


  
    
  
  
    
  

<figure class="codeblock codeblock--tabbed">
  <figcaption>
    
      <span><a href="https://gist.github.com/reyhansofian/7d8db68335870d5a889fabbd5e221413#file-app-js">app.js</a></span>
    
    <ul class="tabs">
      
        <li class="tab active">js</li>
      
    </ul>
  </figcaption> 
  <div class="tabs-content">
    
      
      <figure class="highlight language-js" style="display: block;">   
        <table>
          <tbody>
            <tr>
              <td class="gutter">
                <pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br></pre>
              </td>
              <td class="code">
                <pre class="code-highlight language-js"><code class="js">// @ts-check

const express = require(&#34;express&#34;);
const app = express();
const fs = require(&#34;fs&#34;);
const bodyParser = require(&#39;body-parser&#39;);

const mountPath = &#34;/etc/config&#34;;
const configMapFile = &#34;..data&#34;;

function readConfig() {
  const dir = fs.readdirSync(`${mountPath}/${configMapFile}`);

  console.log(`Available envar: ${dir}`);

  dir.forEach(env =&gt; {
    process.env[env] = fs.readFileSync(
      `${mountPath}/${configMapFile}/${env}`
    );
  });
}

app.get(&#34;/info&#34;, (req, res) =&gt; {
  res.sendStatus(200);
});

app.use(bodyParser.json());

// configmap reload webhook
app.post(&#34;/-/reload&#34;, (req, res) =&gt; {
  // read new ConfigMap value
  readConfigMap();

  console.log(`process.env AFTER: ${JSON.stringify(process.env)}`);

  res.sendStatus(200);
});

app.get(&#34;/isMaintenance&#34;, (req, res) =&gt; {
  const isMaintenace = process.env.ENV_IS_MAINTENANCE;

  res.status(200).send(`Is it maintenance? ${isMaintenace}`);
})

app.listen(3000, err =&gt; {
  if (err) {
    console.error(err);
    process.exit(1);
  }

  console.log(`Server is up on port 3000`);
});</code></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </figure>
    
  </div>
</figure>
<p>On the NodeJS application, we need to add a new endpoint to receive the notification from the sidecar container (<strong>&ldquo;configmap-reload&rdquo;</strong> container).</p>

 
  
  
  
  
    
      
    
  
    
      
    
  
    
  
    
      
    
  

 
  
  
  
  
    
  
    
      
    
  
    
      
    
  

<div class="figure center fig-100" >
  
    <a class="fancybox" href="https://miro.medium.com/max/1400/1*QKmTx-uhZQZ85gynZWDlrw.png" data-fancybox-group="">
  
    <img class="fig-img" src="https://miro.medium.com/max/1400/1*QKmTx-uhZQZ85gynZWDlrw.png" >
  
    </a>
  
  
</div>

  <div style="clear:both;"></div>

<p>With this method, the application flow will be like this</p>
<ol>
<li>Sidecar container <strong>&ldquo;configmap-reload&rdquo;</strong> will watch if there is any update on the environment variables files inside the volume</li>
<li>If those files got updated, sidecar container <strong>&ldquo;configmap-reload&rdquo;</strong> will send a notification (HTTP call) to our main container&rsquo;s endpoint <code>/-/reload</code> (same with the <code>--webhook-url</code> parameter on the sidecar container)</li>
<li>The main application will re-read all environment variables files and then store it on the global object <code>process.env</code></li>
</ol>
<p>Using this method, we can implement &ldquo;live-update&rdquo; to every programming language that we like. Happy coding!</p>
<hr>
<h1 id="references">References</h1>
<ul>
<li><a href="https://unofficial-kubernetes.readthedocs.io/en/latest/tasks/configure-pod-container/configmap/">https://unofficial-kubernetes.readthedocs.io/en/latest/tasks/configure-pod-container/configmap/</a></li>
<li><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/configmap">https://cloud.google.com/kubernetes-engine/docs/concepts/configmap</a></li>
<li><a href="https://www.slideshare.net/kubecon/kubecon-eu-2016-keynote-kubernetes-state-of-the-union">https://www.slideshare.net/kubecon/kubecon-eu-2016-keynote-kubernetes-state-of-the-union</a></li>
<li><a href="https://medium.com/@xcoulon/kubernetes-configmap-hot-reload-in-action-with-viper-d413128a1c9a">https://medium.com/@xcoulon/kubernetes-configmap-hot-reload-in-action-with-viper-d413128a1c9a</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/30189">https://github.com/kubernetes/kubernetes/issues/30189</a></li>
<li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap">https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap</a></li>
<li><a href="https://github.com/jimmidyson/configmap-reload">https://github.com/jimmidyson/configmap-reload</a></li>
</ul>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://reyhansofian.github.io/en/tags/kubernetes/">kubernetes</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://reyhansofian.github.io/en/post/live-reload-golang-development-with-gin/" data-tooltip="Live Reload Golang Development With Gin">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://reyhansofian.github.io/en/post/installing-gollum-on-osx-catalina/" data-tooltip="Installing Gollum on OSX Catalina">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
      
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Reyhan Sofian. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://reyhansofian.github.io/en/post/live-reload-golang-development-with-gin/" data-tooltip="Live Reload Golang Development With Gin">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://reyhansofian.github.io/en/post/installing-gollum-on-osx-catalina/" data-tooltip="Installing Gollum on OSX Catalina">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://reyhansofian.github.io/en/post/kubernetes-configmap-on-dynamic-applications/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
      
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Freyhansofian.github.io%2Fen%2Fpost%2Fkubernetes-configmap-on-dynamic-applications%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Freyhansofian.github.io%2Fen%2Fpost%2Fkubernetes-configmap-on-dynamic-applications%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/291bcee126afd5d5e6fe20e2b4ce3153?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Reyhan Sofian</h4>
    
      <div id="about-card-bio">Just another software engineer</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Engineering Manager @ <a href="https://kata.ai">Kata.ai</a>
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Indonesia
      </div>
    
  </div>
</div>

    

    
  
    <div id="cover" style="background-image:url('https://res.cloudinary.com/dweyilbvh/image/upload/v1496287728/cover_gkeq0u.png');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://reyhansofian.github.io/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/reyhansofian.github.io\/en\/post\/kubernetes-configmap-on-dynamic-applications\/';
          
            this.page.identifier = '\/en\/post\/kubernetes-configmap-on-dynamic-applications\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'reyhansofian';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  




    
  </body>
</html>

